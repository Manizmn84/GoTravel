<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Airport Routes List</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>

<body class="min-h-screen bg-gradient-to-br from-[#1e1b4b] via-[#312e81] to-[#020617] text-gray-100">
  <div id="root" class="min-h-screen flex items-center justify-center px-4"></div>

  <script type="text/babel">
    function App() {
      const [airports, setAirports] = React.useState([]);
      const [airportId, setAirportId] = React.useState("");
      const [routes, setRoutes] = React.useState([]);
      const [loading, setLoading] = React.useState(false);

      React.useEffect(() => {
        fetch("http://localhost:8080/airports")
          .then(res => res.json())
          .then(r => setAirports(r.data || []));
      }, []);

      React.useEffect(() => {
        if (!airportId) return;

        setLoading(true);
        fetch(
          "http://localhost:8080/reports/airport-routes-list?airport_id=" +
            airportId
        )
          .then(res => res.json())
          .then(r => setRoutes(r.data || []))
          .finally(() => setLoading(false));
      }, [airportId]);

      return (
        <div className="w-full max-w-4xl">
          <div className="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-2xl p-6">
            <h1 className="text-2xl font-bold text-center mb-6 text-indigo-200">
              Airport Routes List
            </h1>

            <select
  value={airportId}
  onChange={(e) => setAirportId(e.target.value)}
  className="w-full mb-6 bg-slate-900/70 border border-indigo-500/40
             rounded-lg px-3 py-2"
>
  <option value="">-- Select Airport --</option>

  {airports.map((a, index) => {
    const id = a.id != null ? a.id : a.ID;

    return (
      <option
        key={id + "-" + index}   // ✅ key یکتا
        value={id}
      >
        {a.name || a.Name}
      </option>
    );
  })}
</select>


            {loading && (
              <div className="text-center text-indigo-300">Loading...</div>
            )}

            {!loading && routes.length > 0 && (
              <table className="w-full text-sm border border-white/20 rounded-lg overflow-hidden">
                <thead className="bg-indigo-900/40">
                  <tr>
                    <th className="p-2 text-left">Origin</th>
                    <th className="p-2 text-left">Destination</th>
                    <th className="p-2 text-center">Type</th>
                  </tr>
                </thead>
                <tbody>
                  {routes.map((r, i) => (
                    <tr key={i} className="border-t border-white/10">
                      <td className="p-2">{r.origin_airport}</td>
                      <td className="p-2">{r.destination_airport}</td>
                      <td className="p-2 text-center">
                        <span
                          className={
                            r.route_type === "OUTGOING"
                              ? "text-emerald-300"
                              : "text-sky-300"
                          }
                        >
                          {r.route_type}
                        </span>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>